A set of passing tests along with code is given. When you run gradlew the tests pass but the PMD metrics for code complexity fails.

First, let's identify the lack of design quality, what principles are being violated. Then, let's refactor the code to reduce the code complexity. Please make sure that the tests pass after change.